<!--
  ___ ___ ___   ___ ___ _____   _____ ___ ___   __  __   _   ___
 | __| _ )_ _| / __| __| _ \ \ / /_ _/ __| __| |  \/  | /_\ | _ \
 | _|| _ \| |  \__ \ _||   /\ V / | | (__| _|  | |\/| |/ _ \|  _/
 |___|___/___| |___/___|_|_\ \_/ |___\___|___| |_|  |_/_/ \_\_|

                 ,_   .  ._. _.  .
           , _-\','|~\~      ~/      ;-'_   _-'     ,;_;_,    ~~-
  /~~-\_/-'~'- ' \~~| ',    ,'      /  / ~|-_\_/~/~      ~~ -~~~~' -_
  /              ,/'-/~ '\ ,' _  , '|,'|~                   ._/-, /~
  ~/-'~\_,       '-,| '|. '   ~  ,\ /'~                /    /_  /~
.-~      '|        '',\~|\       _\~     ,_  ,               /|
          '\        /'~          |_/~\\,-,~  \ "         ,_,/ |
           |       /            ._-~'\_ _~|              \ ) /
            \   __-\           '/      ~ |\  \_          /  ~
  .,         '\ |,  ~-_      - |          \\_' ~|  /\  \~ ,
               ~-_'  _;       '\           '-,   \,' /\/  |
                 '\_,~'\_       \_ _,       /'    '  |, /|'
                   /     \_       ~ |      /         \  ~'; -,_.
                   |       ~\        |    |  ,        '-_, ,; ~ ~\
                    \,      /        \    / /|            ,-, ,   -,
                     |    ,/          |  |' |/          ,-   ~ \   '.
                    ,|   ,/           \ ,/              \       |
                    /    |             ~                 -~~-, /   _
                    |  ,-'                                    ~    /
                    / ,'                                      ~
                    ',|  ~
                      ~'

  The EMBL-EBI Live Data Map shows utilisation of the:
  - EBI Services
  - Portal pages
  - Uniprot

  The canonical URL is: http://www.ebi.ac.uk/web/livemap

  To show on a website, embed with this iframe code:
  <iframe id="ebiTrafficMap"
      name="ebiTrafficMap"
      title="ebiTrafficMap"
      width="500"
      height="500"
      frameborder="0"
      scrolling="no"
      marginheight="0"
      marginwidth="0"
      style="width: 100%
      src="//www.ebi.ac.uk/web/livemap">
  </iframe>

  The map and its asset URLs are subject to change, so please do not directly code the map into your web page.

  Updates:
    2016-12-14: Initial go-live
  Credits:
    - Philip Lewis: Backend server log queries, first implementation (http://wwwdev.ebi.ac.uk/ebiwebtrafficmap/kmlvector.html)
    - Ken Hawkins: Visual polish, various log optimisations, and MapBox-based implementation

  Please post feedback on GitHub to https://github.com/ebiwd/EMBL-EBI-Live-data-map or to www-dev@ebi.ac.uk

 -->

<!DOCTYPE html>
<html class="fontface">
<head>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <link href='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.css' rel='stylesheet' />
  <link href='https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0/MarkerCluster.css' rel='stylesheet' />
  <link href='https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0/MarkerCluster.Default.css' rel='stylesheet' />
  <link rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/EBI-Icon-fonts/v1.1/fonts.css" />
  <link rel="stylesheet" href="assets/map_styles.css" />
</head>

<body>
  <div id="map"></div>

  <div id="state-legend" class="legend modal">
    <h4>Request type</h4>
    <div class="markerClustersEBI"><span class="legend-icon" style='background-color: rgba(168,200,19,.4)'></span>EMBL-EBI</div>
    <div class="markerClustersPortals"><span class="legend-icon" style='background-color: rgba(235,98,9,.4)'></span>Portals</div>
    <div class="markerClustersUniprot"><span class="legend-icon" style='background-color: rgba(29,92,116,.4)'></span>Uniprot</div>
    <div><a href="#" class="pause"><span class="icon icon-functional" data-icon="o"></span>Pause</a></div>
  </div>

  <script src='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.js'></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>
  <script src="//www.ebi.ac.uk/sites/ebi.ac.uk/modules/contrib/jquery_update/replace/jquery/1.10/jquery.min.js?v=1.10.2"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.0/leaflet.markercluster.js'></script>
  <script type="text/javascript" src="//rawgithub.com/joergdietrich/Leaflet.Terminator/master/L.Terminator.js"></script>
  <script type="text/javascript" src="assets/map_scripts.js"></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('set', 'anonymizeIp', true);
    ga('create', 'UA-629242-1', 'auto');
    ga('send', 'pageview');

  </script>

</body>
</html>
